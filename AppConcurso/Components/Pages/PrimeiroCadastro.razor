@page "/primeiroCadastro"
@using AppConcurso.Models;
@using AppConcurso.Controllers;
@inject InscricaoController inscControl;
@inject CargoController cargoControl;
@inject CandidatoController candControl;
@inject NavigationManager navegacao;


@code {
    
     private List<Cargo> listaCargos = new List<Cargo>();
    private List<Candidato> listaCandidatos = new List<Candidato>();
    
    private Cargo cargo = new Cargo();
    private Candidato candidato = new Candidato();

    private bool enabledButton = true;
    private string numeroInsc = "";
    private async Task Salvar()
    {
        Inscricao inscricao = new Inscricao();
        inscricao.DataInscricao = DateTime.Today;
        inscricao.NumeroInsc = numeroInsc;
        inscricao.Cargo = cargo;
        inscricao.Candidato = candidato;

        await inscControl.Add(inscricao);
        await inscControl.Salvar();
        enabledButton = false;
    }

    private void Cancelar()
    {
        navegacao.NavigateTo("/inscricao", forceLoad: true);
    }

    public void SelecionarCandidatos(ChangeEventArgs e)
    {
        string cpf = e.Value.ToString();
        // seleciona uma pessoa específica para registrar os bens
        candidato = listaCandidatos.Where(p => p.Cpf == cpf).FirstOrDefault();
    }

    public void SelecionarCargos (ChangeEventArgs e)
    {
        int id = Convert.ToInt32(e.Value.ToString());
        //seleciona uma pessoa específica para registrar os bens
        cargo = listaCargos.Where(p => p.Id == id).FirstOrDefault();
    }

    public void NovaInscricao()
    {
        navegacao.NavigateTo("/inscricao", forceLoad: true);
    }


}